<div class="bg-card rounded-2xl shadow p-6">
    <div class="flex items-center justify-between mb-6">
        <h3 class="text-lg font-semibold">Custom Styling</h3>
        <button
            class="px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700"
            (click)="reset.emit()">
            Reset
        </button>
    </div>
    <form [formGroup]="form" class="space-y-6">
        <div>
            <h4 class="font-medium mb-3">Business Identity & Branding</h4>
            <div class="space-y-4">
                <mat-checkbox formControlName="showLogo">
                    Show Company Logo
                </mat-checkbox>
                <div *ngIf="form.get('showLogo')?.value" class="space-y-4">

                    <div class="grid grid-cols-2 gap-4">
                        <mat-form-field class="w-full">
                            <mat-label>Logo URL</mat-label>
                            <input matInput type="url" formControlName="logoUrl" placeholder="https://example.com/logo.png">
                        </mat-form-field>
                        <div class="flex flex-col items-start w-full mb-4">
                            <mat-label>
                                Upload Logo (PNG/JPG)
                            </mat-label>
                            <label class="inline-flex items-center w-full py-3 mt-1 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors px-3 py-2">                                <mat-icon class="mr-2" [svgIcon]="'heroicons_outline:arrow-up-tray'"></mat-icon>
                                <span>Choose File</span>
                                <input
                                    type="file"
                                    accept="image/*"
                                    (change)="onLogoFileSelected($event)"
                                    class="hidden"
                                >
                            </label>
                            <!-- <span class="text-xs text-gray-500 dark:text-gray-400 mt-1">Recommended: Transparent PNG, at least 200x200px</span> -->
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <mat-form-field class="w-full">
                            <mat-label>Logo Size (0 - 0.5)</mat-label>
                            <input matInput type="number" formControlName="logoSize" min="0" max="0.5" step="0.1">
                            <mat-hint>Relative to QR code size</mat-hint>
                        </mat-form-field>
                        <mat-form-field class="w-full">
                            <mat-label>Logo Margin (px)</mat-label>
                            <input matInput type="number" formControlName="logoMargin" min="0" step="1">
                        </mat-form-field>
                    </div>

                    <div class="mt-3">
                        <mat-checkbox formControlName="hideBackgroundDots">
                            Hide background dots behind logo
                        </mat-checkbox>
                        <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                            Removes QR code dots that would overlap with your logo for cleaner appearance
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <h4 class="font-medium mb-3">General Appearance</h4>
            <mat-form-field class="w-full">
                <mat-label>Size (px)</mat-label>
                <input matInput type="number" formControlName="size" min="100" max="1000">
            </mat-form-field>
            <mat-form-field class="w-full">
                <mat-label>Background Color</mat-label>
                <input matInput type="color" formControlName="backgroundColor">
            </mat-form-field>
        </div>
        <div>
            <h4 class="font-medium mb-3">QR Code Functionality</h4>
            <mat-form-field class="w-full">
                <mat-label>Error Correction Level</mat-label>
                <mat-select formControlName="errorCorrectionLevel">
                    <mat-option *ngFor="let type of errorCorrectionLevels" [value]="type.value">
                        {{ type.label }}
                    </mat-option>
                </mat-select>
                <mat-hint>Higher levels allow more recovery from damage to the QR code.</mat-hint>
            </mat-form-field>
        </div>
        <div>
            <h4 class="font-medium mb-3">Visual Styling</h4>
            <div class="space-y-4">
                <mat-form-field class="w-full">
                    <mat-label>Dot Style</mat-label>
                    <mat-select formControlName="dotStyle">
                        <mat-option *ngFor="let type of dotTypes" [value]="type.value">
                            {{ type.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <div>
                    <h5 class="text-sm font-medium mb-2">Dot Color</h5>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-3">
                            <mat-form-field class="w-full">
                                <mat-label>Color Type</mat-label>
                                <mat-select formControlName="colorType">
                                    <mat-option *ngFor="let type of colorTypes" [value]="type.value">
                                        {{ type.label }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <mat-form-field *ngIf="form.get('colorType')?.value === 'single'" class="w-full">
                            <mat-label>Color</mat-label>
                            <input matInput type="color" formControlName="dotColor">
                        </mat-form-field>
                        <div *ngIf="form.get('colorType')?.value === 'gradient'" formGroupName="dotGradient" class="space-y-3">
                            <mat-form-field class="w-full">
                                <mat-label>Gradient Type</mat-label>
                                <mat-select formControlName="type">
                                    <mat-option value="linear">Linear</mat-option>
                                    <mat-option value="radial">Radial</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field class="w-full">
                                <mat-label>Rotation (radians)</mat-label>
                                <input matInput type="number" formControlName="rotation" step="0.1">
                            </mat-form-field>
                            <div formArrayName="colorStops" class="space-y-2">
                                <div *ngFor="let stop of dotGradientStops.controls; let i = index" [formGroupName]="i" class="flex gap-2">
                                    <mat-form-field class="flex-1">
                                        <mat-label>Offset {{ i === 0 ? '(Start)' : '(End)' }}</mat-label>
                                        <input matInput type="number" formControlName="offset" min="0" max="1" step="0.1">
                                    </mat-form-field>
                                    <mat-form-field class="flex-1">
                                        <mat-label>Color</mat-label>
                                        <input matInput type="color" formControlName="color">
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <h4 class="font-medium mb-3">Professional Finishing</h4>
            <div class="space-y-4">
                <div>
                    <h5 class="text-sm font-medium mb-2">Corner Squares</h5>
                    <mat-form-field class="w-full">
                        <mat-label>Style</mat-label>
                        <mat-select formControlName="cornerSquareType">
                            <mat-option *ngFor="let type of cornerSquareTypes" [value]="type.value">
                                {{ type.label }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-3">
                            <mat-form-field class="w-full">
                                <mat-label>Color Type</mat-label>
                                <mat-select formControlName="cornerSquareColorType">
                                    <mat-option *ngFor="let type of colorTypes" [value]="type.value">
                                        {{ type.label }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <mat-form-field *ngIf="form.get('cornerSquareColorType')?.value === 'single'" class="w-full">
                            <mat-label>Color</mat-label>
                            <input matInput type="color" formControlName="cornerSquareColor">
                        </mat-form-field>

                        <div *ngIf="form.get('cornerSquareColorType')?.value === 'gradient'" formGroupName="cornerSquareGradient" class="space-y-3">
                            <mat-form-field class="w-full">
                                <mat-label>Gradient Type</mat-label>
                                <mat-select formControlName="type">
                                    <mat-option value="linear">Linear</mat-option>
                                    <mat-option value="radial">Radial</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field class="w-full">
                                <mat-label>Rotation (radians)</mat-label>
                                <input matInput type="number" formControlName="rotation" step="0.1">
                            </mat-form-field>
                            <div formArrayName="colorStops" class="space-y-2">
                                <div *ngFor="let stop of cornerSquareGradientStops.controls; let i = index" [formGroupName]="i" class="flex gap-2">
                                    <mat-form-field class="flex-1">
                                        <mat-label>Offset {{ i === 0 ? '(Start)' : '(End)' }}</mat-label>
                                        <input matInput type="number" formControlName="offset" min="0" max="1" step="0.1">
                                    </mat-form-field>
                                    <mat-form-field class="flex-1">
                                        <mat-label>Color</mat-label>
                                        <input matInput type="color" formControlName="color">
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <h5 class="text-sm font-medium mb-2">Corner Dots</h5>
                    <mat-form-field class="w-full">
                        <mat-label>Style</mat-label>
                        <mat-select formControlName="cornerDotType">
                            <mat-option *ngFor="let type of cornerDotTypes" [value]="type.value">
                                {{ type.label }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-3">
                        <mat-form-field class="w-full">
                            <mat-label>Color Type</mat-label>
                            <mat-select formControlName="cornerDotColorType">
                                <mat-option *ngFor="let type of colorTypes" [value]="type.value">
                                    {{ type.label }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        </div>
                        <mat-form-field *ngIf="form.get('cornerDotColorType')?.value === 'single'" class="w-full">
                            <mat-label>Color</mat-label>
                            <input matInput type="color" formControlName="cornerDotColor">
                        </mat-form-field>
                        <div *ngIf="form.get('cornerDotColorType')?.value === 'gradient'" formGroupName="cornerDotGradient" class="space-y-3">
                            <mat-form-field class="w-full">
                                <mat-label>Gradient Type</mat-label>
                                <mat-select formControlName="type">
                                    <mat-option value="linear">Linear</mat-option>
                                    <mat-option value="radial">Radial</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field class="w-full">
                                <mat-label>Rotation (radians)</mat-label>
                                <input matInput type="number" formControlName="rotation" step="0.1">
                            </mat-form-field>
                            <div formArrayName="colorStops" class="space-y-2">
                                <div *ngFor="let stop of cornerDotGradientStops.controls; let i = index" [formGroupName]="i" class="flex gap-2">
                                    <mat-form-field class="flex-1">
                                        <mat-label>Offset {{ i === 0 ? '(Start)' : '(End)' }}</mat-label>
                                        <input matInput type="number" formControlName="offset" min="0" max="1" step="0.1">
                                    </mat-form-field>
                                    <mat-form-field class="flex-1">
                                        <mat-label>Color</mat-label>
                                        <input matInput type="color" formControlName="color">
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </form>
</div>


